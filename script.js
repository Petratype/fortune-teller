
// --- Multilanguage Fortunes ---
const fortunes = {
  EN: [
    "The shadow you chase will reveal its own light.",
    "Whispers in silence carry the answer you seek.",
    "A path closes only to guide you to a hidden gate.",
    "What is lost waits patiently to be found again.",
    "The next turn of the moon will alter your course.",
    "The stars hold a secret only you can unlock.",
    "A chance encounter will echo in your future.",
    "The silence between words hides the true message.",
    "Your steps are guided by a rhythm older than time.",
    "An invisible ally awaits you in the shadows.",
    "Your Wi-Fi will connect on the first try today.",
    "You will finally remember why you entered that room.",
    "Beware: free samples may lead to lifelong commitments.",
    "Someone will like your meme more than you do.",
    "Your socks will vanish, but only the left ones.",
    "Today you will defeat the printer in battle.",
    "Beware the autocorrect: it knows too much.",
    "An unplanned nap will change your destiny.",
    "Your future looks brightâ€¦ once you recharge your phone.",
    "You will open the fridge and find exactly what you forgot you wanted.",
    "An unexpected snack will bring unexpected joy.",
    "The spilled coffee will be a sign of greatness.",
    "Your cat/dog will judge your life choices today.",
    "You will find a sock... but only when itâ€™s too late.",
    "Your message will eventually reach the right person.",
    "A song stuck in your head contains the answers you need.",
    "The ice cream aisle holds the key to happiness.",
    "Your password will work on the first try.",
    "Someone will compliment you today, for no reason.",
    "Your online order will arrive faster than expected.",
    "Today you master the art of not tripping over anything."
  ],

  ES: [
    "La sombra que perseguÃ­s va a revelar su propia luz.",
    "Los susurros del silencio traen la respuesta que buscÃ¡s.",
    "Un camino se cierra solo para guiarte hacia una puerta escondida.",
    "Lo que perdiste te espera, paciente, para ser encontrado otra vez.",
    "El prÃ³ximo giro de la luna cambiarÃ¡ tu rumbo.",
    "Las estrellas guardan un secreto que solo vos podÃ©s descubrir.",
    "Un encuentro casual va a resonar en tu futuro.",
    "El silencio entre las palabras esconde el verdadero mensaje.",
    "Tus pasos siguen un ritmo mÃ¡s antiguo que el tiempo.",
    "Un aliado invisible te espera entre las sombras.",
    "Tu Wi-Fi se va a conectar al primer intento hoy.",
    "Por fin te vas a acordar por quÃ© entraste a esa habitaciÃ³n.",
    "Cuidado: las muestras gratis pueden volverse compromisos eternos.",
    "Alguien va a disfrutar tu meme mÃ¡s que vos.",
    "Tus medias van a desaparecer, pero solo las izquierdas.",
    "Hoy vas a derrotar a la impresora en batalla.",
    "Cuidado con el autocorrector: sabe demasiado.",
    "Una siesta no planeada va a cambiar tu destino.",
    "Tu futuro se ve brillante... cuando cargues el celular.",
    "Vas a abrir la heladera y encontrar justo eso que ni recordabas que querÃ­as.",
    "Un snack inesperado te va a traer una alegrÃ­a inesperada.",
    "El cafÃ© derramado serÃ¡ seÃ±al de grandeza.",
    "Tu gato o perro hoy va a juzgar tus decisiones de vida.",
    "Vas a encontrar una media... pero demasiado tarde.",
    "Tu mensaje va a llegar, aunque tarde, a la persona correcta.",
    "La canciÃ³n que no se te va de la cabeza tiene las respuestas que buscÃ¡s.",
    "La gÃ³ndola de los helados guarda la clave de la felicidad.",
    "Tu contraseÃ±a va a funcionar al primer intento.",
    "Alguien te va a halagar hoy, sin motivo alguno.",
    "Tu pedido online va a llegar antes de lo esperado.",
    "Hoy dominÃ¡s el arte de no tropezarte con nada."
  ],

  NO: [
    "Skyggen du jager vil avslÃ¸re sitt eget lys.",
    "Hvisking i stillhet bÃ¦rer svaret du sÃ¸ker.",
    "En vei lukkes bare for Ã¥ lede deg til en skjult port.",
    "Det som er tapt venter tÃ¥lmodig pÃ¥ Ã¥ bli funnet igjen.",
    "Neste mÃ¥neskifte vil endre kursen din.",
    "Stjernene holder pÃ¥ en hemmelighet bare du kan lÃ¥se opp.",
    "Et tilfeldig mÃ¸te vil gi gjenklang i fremtiden din.",
    "Stillheten mellom ordene skjuler det sanne budskapet.",
    "Dine steg blir styrt av en rytme eldre enn tiden.",
    "En usynlig alliert venter pÃ¥ deg i skyggene.",
    "Wi-Fi-en din vil koble til pÃ¥ fÃ¸rste forsÃ¸k i dag.",
    "Du vil endelig huske hvorfor du gikk inn i det rommet.",
    "Pass opp: gratisprÃ¸ver kan fÃ¸re til livslange forpliktelser.",
    "Noen vil like memen din mer enn du gjÃ¸r.",
    "Sokkene dine vil forsvinne â€” bare de venstre.",
    "I dag vil du seire over printeren i kamp.",
    "Pass deg for autokorrektur: den vet for mye.",
    "En uplanlagt lur vil endre skjebnen din.",
    "Fremtiden din ser lys utâ€¦ nÃ¥r du lader telefonen.",
    "Du vil Ã¥pne kjÃ¸leskapet og finne akkurat det du glemte at du ville ha.",
    "En uventet snacks vil gi uventet glede.",
    "Den sÃ¸lte kaffen vil vÃ¦re et tegn pÃ¥ storhet.",
    "Katten eller hunden din vil dÃ¸mme livsvalgene dine i dag.",
    "Du vil finne en sokk... men for sent.",
    "Meldingen din vil til slutt nÃ¥ den rette personen.",
    "Sangen som sitter fast i hodet ditt har svarene du trenger.",
    "Isdisken holder nÃ¸kkelen til lykke.",
    "Passordet ditt vil fungere pÃ¥ fÃ¸rste forsÃ¸k.",
    "Noen vil gi deg et kompliment i dag, uten grunn.",
    "Bestillingen din vil komme raskere enn du forventet.",
    "I dag mestrer du kunsten Ã¥ ikke snuble i noe."
  ],

  PT: [
    "A sombra que vocÃª persegue vai revelar sua prÃ³pria luz.",
    "Os sussurros do silÃªncio trazem a resposta que vocÃª procura.",
    "Um caminho se fecha apenas para guiÃ¡-lo atÃ© um portÃ£o escondido.",
    "O que foi perdido espera pacientemente para ser encontrado novamente.",
    "A prÃ³xima virada da lua mudarÃ¡ seu rumo.",
    "As estrelas guardam um segredo que sÃ³ vocÃª pode desvendar.",
    "Um encontro inesperado ecoarÃ¡ no seu futuro.",
    "O silÃªncio entre as palavras esconde a verdadeira mensagem.",
    "Seus passos sÃ£o guiados por um ritmo mais antigo que o tempo.",
    "Um aliado invisÃ­vel espera por vocÃª nas sombras.",
    "Seu Wi-Fi vai conectar de primeira hoje.",
    "VocÃª finalmente vai lembrar por que entrou naquele cÃ´modo.",
    "Cuidado: amostras grÃ¡tis podem se tornar compromissos eternos.",
    "AlguÃ©m vai gostar do seu meme mais do que vocÃª.",
    "Suas meias vÃ£o sumir â€” mas sÃ³ as esquerdas.",
    "Hoje vocÃª vencerÃ¡ a impressora na batalha.",
    "Cuidado com o autocorretor: ele sabe demais.",
    "Um cochilo inesperado mudarÃ¡ seu destino.",
    "Seu futuro parece brilhanteâ€¦ assim que carregar o celular.",
    "VocÃª abrirÃ¡ a geladeira e encontrarÃ¡ exatamente o que queria sem lembrar.",
    "Um lanche inesperado trarÃ¡ alegria inesperada.",
    "O cafÃ© derramado serÃ¡ um sinal de grandeza.",
    "Seu gato ou cachorro julgarÃ¡ suas escolhas de vida hoje.",
    "VocÃª encontrarÃ¡ uma meia... mas tarde demais.",
    "Sua mensagem acabarÃ¡ chegando Ã  pessoa certa.",
    "A mÃºsica na sua cabeÃ§a contÃ©m as respostas que vocÃª precisa.",
    "O corredor dos sorvetes guarda a chave da felicidade.",
    "Sua senha funcionarÃ¡ na primeira tentativa.",
    "AlguÃ©m vai te elogiar hoje, sem motivo.",
    "Seu pedido online chegarÃ¡ antes do esperado.",
    "Hoje vocÃª dominarÃ¡ a arte de nÃ£o tropeÃ§ar em nada."
  ],

  DE: [
    "Der Schatten, den du jagst, wird sein eigenes Licht offenbaren.",
    "FlÃ¼stern in der Stille trÃ¤gt die Antwort, die du suchst.",
    "Ein Weg schlieÃŸt sich nur, um dich zu einem verborgenen Tor zu fÃ¼hren.",
    "Was verloren ist, wartet geduldig darauf, wiedergefunden zu werden.",
    "Die nÃ¤chste Mondwende wird deinen Kurs verÃ¤ndern.",
    "Die Sterne bergen ein Geheimnis, das nur du entschlÃ¼sseln kannst.",
    "Eine zufÃ¤llige Begegnung wird in deiner Zukunft widerhallen.",
    "Die Stille zwischen den Worten verbirgt die wahre Botschaft.",
    "Deine Schritte werden von einem Rhythmus gefÃ¼hrt, Ã¤lter als die Zeit.",
    "Ein unsichtbarer VerbÃ¼ndeter erwartet dich in den Schatten.",
    "Dein WLAN wird sich heute beim ersten Versuch verbinden.",
    "Du wirst dich endlich erinnern, warum du diesen Raum betreten hast.",
    "Vorsicht: Gratisproben kÃ¶nnen zu lebenslangen Verpflichtungen fÃ¼hren.",
    "Jemand wird dein Meme mehr mÃ¶gen als du.",
    "Deine Socken werden verschwinden â€” aber nur die linken.",
    "Heute wirst du den Drucker im Kampf besiegen.",
    "HÃ¼te dich vor der Autokorrektur: Sie weiÃŸ zu viel.",
    "Ein ungeplanter Mittagsschlaf wird dein Schicksal verÃ¤ndern.",
    "Deine Zukunft sieht hell ausâ€¦ sobald du dein Handy auflÃ¤dst.",
    "Du wirst den KÃ¼hlschrank Ã¶ffnen und genau das finden, was du vergessen hattest, dass du wolltest.",
    "Ein unerwarteter Snack wird unerwartete Freude bringen.",
    "VerschÃ¼tteter Kaffee wird ein Zeichen von GrÃ¶ÃŸe sein.",
    "Deine Katze oder dein Hund wird heute deine Lebensentscheidungen beurteilen.",
    "Du wirst eine Socke finden... aber zu spÃ¤t.",
    "Deine Nachricht wird schlieÃŸlich die richtige Person erreichen.",
    "Das Lied in deinem Kopf enthÃ¤lt die Antworten, die du brauchst.",
    "Das Eisregal enthÃ¤lt den SchlÃ¼ssel zum GlÃ¼ck.",
    "Dein Passwort wird beim ersten Versuch funktionieren.",
    "Jemand wird dich heute ohne Grund loben.",
    "Deine Online-Bestellung wird frÃ¼her als erwartet ankommen.",
    "Heute meisterst du die Kunst, Ã¼ber nichts zu stolpern."
  ],

  FR: [
    "Lâ€™ombre que tu poursuis rÃ©vÃ©lera sa propre lumiÃ¨re.",
    "Les murmures du silence portent la rÃ©ponse que tu cherches.",
    "Un chemin se ferme seulement pour te guider vers une porte cachÃ©e.",
    "Ce qui est perdu attend patiemment dâ€™Ãªtre retrouvÃ©.",
    "Le prochain tour de la lune changera ta trajectoire.",
    "Les Ã©toiles gardent un secret que toi seul peux dÃ©voiler.",
    "Une rencontre fortuite rÃ©sonnera dans ton avenir.",
    "Le silence entre les mots cache le vrai message.",
    "Tes pas sont guidÃ©s par un rythme plus ancien que le temps.",
    "Un alliÃ© invisible tâ€™attend dans lâ€™ombre.",
    "Ton Wi-Fi se connectera du premier coup aujourdâ€™hui.",
    "Tu te souviendras enfin pourquoi tu es entrÃ© dans cette piÃ¨ce.",
    "Attention : les Ã©chantillons gratuits peuvent devenir des engagements Ã  vie.",
    "Quelquâ€™un aimera ton mÃ¨me plus que toi.",
    "Tes chaussettes disparaÃ®tront â€” mais seulement les gauches.",
    "Aujourdâ€™hui, tu vaincras lâ€™imprimante au combat.",
    "MÃ©fie-toi de lâ€™autocorrecteur : il en sait trop.",
    "Une sieste imprÃ©vue changera ton destin.",
    "Ton avenir semble brillantâ€¦ une fois ton tÃ©lÃ©phone rechargÃ©.",
    "Tu ouvriras le frigo et trouveras exactement ce que tu avais oubliÃ© vouloir.",
    "Un en-cas inattendu tâ€™apportera une joie inattendue.",
    "Le cafÃ© renversÃ© sera un signe de grandeur.",
    "Ton chat ou ton chien jugera tes choix de vie aujourdâ€™hui.",
    "Tu trouveras une chaussette... mais trop tard.",
    "Ton message atteindra finalement la bonne personne.",
    "La chanson coincÃ©e dans ta tÃªte contient les rÃ©ponses dont tu as besoin.",
    "Le rayon des glaces dÃ©tient la clÃ© du bonheur.",
    "Ton mot de passe fonctionnera du premier coup.",
    "Quelquâ€™un te complimentera aujourdâ€™hui, sans raison.",
    "Ta commande en ligne arrivera plus vite que prÃ©vu.",
    "Aujourdâ€™hui, tu maÃ®triseras lâ€™art de ne trÃ©bucher sur rien."
  ]
};
// --- Button text by language ---
const buttonLabels = {
  EN: "Reveal Fortune",
  ES: "RevelÃ¡ tu destino",
  NO: "AvslÃ¸r skjebnen",
  PT: "Revele sua sorte",
  DE: "Offenbare dein Schicksal",
  FR: "RÃ©vÃ¨le ta destinÃ©e"
};

// --- Title text by language ---
const titles = {
  EN: "ðŸ”® Your Fortune",
  ES: "ðŸ”® Tu Fortuna",
  NO: "ðŸ”® Din Skjebne",
  PT: "ðŸ”® Sua Sorte",
  DE: "ðŸ”® Dein Schicksal",
  FR: "ðŸ”® Ta DestinÃ©e"
};

// --- Select elements ---
const fortuneBtn = document.getElementById("fortune-btn");
const fortuneEl = document.getElementById("fortune");
const titleEl = document.getElementById("title");

// --- Typing control ---
let typingIntervalId = null;

// --- Detect or load language ---
let currentLang = "EN";
const savedLang = localStorage.getItem("fortuneLang");
if (savedLang && fortunes[savedLang]) {
  currentLang = savedLang;
} else {
  const detected = (navigator.language || navigator.userLanguage || "en").slice(0,2).toUpperCase();
  if (fortunes[detected]) currentLang = detected;
  localStorage.setItem("fortuneLang", currentLang);
}

// --- Initialize UI ---
fortuneBtn.textContent = buttonLabels[currentLang];
titleEl.textContent = titles[currentLang];
document.querySelectorAll(".lang-switcher button").forEach((b) => {
  b.classList.toggle("active", b.dataset.lang === currentLang);
});

// --- Sound setup ---
const sound = document.getElementById("button-sound");
sound.volume = 0.4;
sound.preload = "auto";

// --- Force browser to decode/play silently once ---
window.addEventListener("load", () => {
  sound.play().then(() => sound.pause()).catch(() => {});
});

// --- Reveal Fortune ---
fortuneBtn.addEventListener("click", () => {
  // Play button sound instantly
  sound.currentTime = 0;
  sound.play().catch(() => setTimeout(() => sound.play(), 50));

  // Pick and show a random fortune
  const langFortunes = fortunes[currentLang];
  const randomIndex = Math.floor(Math.random() * langFortunes.length);
  const selectedFortune = langFortunes[randomIndex];
  typeFortune(selectedFortune);
});


// --- Typing Animation ---
function typeFortune(text) {
  if (typingIntervalId) clearInterval(typingIntervalId);
  fortuneEl.textContent = "";
  fortuneEl.style.opacity = 1;

  let i = 0;
  typingIntervalId = setInterval(() => {
    fortuneEl.textContent += text.charAt(i);
    i++;
    if (i >= text.length) {
      clearInterval(typingIntervalId);
      typingIntervalId = null;
    }
  }, 50);
}

// --- Find index across all languages ---
function findFortuneIndex(text) {
  for (const lang of Object.keys(fortunes)) {
    const idx = fortunes[lang].indexOf(text);
    if (idx > -1) return idx;
  }
  return -1;
}

// --- Language Switching ---
document.querySelectorAll(".lang-switcher button").forEach((btn) => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".lang-switcher button").forEach((b) =>
      b.classList.remove("active")
    );
    btn.classList.add("active");

    currentLang = btn.dataset.lang;
    fortuneBtn.textContent = buttonLabels[currentLang];
    titleEl.textContent = titles[currentLang];
    localStorage.setItem("fortuneLang", currentLang);

    const currentText = fortuneEl.textContent.trim();
    if (currentText) {
      const index = findFortuneIndex(currentText);
      if (index > -1) typeFortune(fortunes[currentLang][index]);
    }
  });

// --- Background Music with fade ---
const musicBtn = document.getElementById("music-btn");
const music = new Audio("assets/fortune-song.mp3");
music.loop = true;

let musicPlaying = false;
let fadeInterval = null;
const fadeStep = 0.02; // volume increment per step
const fadeIntervalTime = 50; // ms per step

music.volume = 0; // start muted

musicBtn.addEventListener("click", () => {
  if (!musicPlaying) {
    music.play().catch(() => {});
    musicBtn.classList.add("active");
    fadeVolume(true);
    musicPlaying = true;
  } else {
    fadeVolume(false);
    musicBtn.classList.remove("active");
    musicPlaying = false;
  }
});

function fadeVolume(fadeIn) {
  if (fadeInterval) clearInterval(fadeInterval);
  fadeInterval = setInterval(() => {
    if (fadeIn) {
      music.volume = Math.min(music.volume + fadeStep, 0.3); // fade in to 0.3
      if (music.volume >= 0.3) clearInterval(fadeInterval);
    } else {
      music.volume = Math.max(music.volume - fadeStep, 0); // fade out to 0
      if (music.volume <= 0) {
        clearInterval(fadeInterval);
        music.pause();
      }
    }
  }, fadeIntervalTime);
}



});
